# 營業稅申報系統 - 解析營業人進銷項資料檔

## 前言
營業稅媒體申報是現代企業稅務管理中的一個重要環節。隨著數位化時代的來臨，企業需要以電子方式提交進、銷項資料，以確保稅務申報的準確性和及時性。這不僅有助於提升企業的運營效率，還能減少人工錯誤，確保稅務合規。

進、銷項資料檔是營業稅申報的核心部分，包含了企業在特定期間內的所有銷售和購買交易記錄。這些資料需要按照特定的格式和規範進行整理和提交，以便稅務機關能夠準確地進行審核和處理。

由於進、銷項資料檔融合了進項資料及銷項資料，並且需要判斷是否為彙加資料，進而將這些資訊解析後以81字元顯示，本文利用圖說方式解析相關文件，以利於理解及程式碼開發。

## 營業稅建檔程式步驟 5 / 營業稅審核程式步驟 1  
營業稅申報系統分為建檔程式及審核程式，先建立營業人進銷項資料檔可以完成下列分別步驟：
- 建檔程式：步驟5，建檔程式有完整的申報流程，依照流程圖順序操作即可完成申報作業
- 審核程式：步驟1，若已產生網路申報所需的電子媒體檔，可以不透過建檔程式操作，直接使用審核程式針對媒體檔案進行審核、上傳作業

![CleanShot 2024-08-01 at 15 24 24@2x](https://github.com/user-attachments/assets/648a26f0-002b-4f6a-b555-37aaa8bd4564)
![CleanShot 2024-08-01 at 15 24 54@2x](https://github.com/user-attachments/assets/3ef93bf1-1d84-4015-8ef7-7a45f01e2199)

## 營業人進銷項資料檔案格式說明
營業人進銷項資料檔將進項資料、銷項資料及是否為彙加資料融合在81長度中，稍微複雜，下方將利用圖例方式解析，以利於理解。
- 檔案格式
  根據「營業稅電子資料申報繳稅作業要點」，營業人進銷項資料檔為長度81字之txt檔，檔名為營業人統一編號
  
  ![CleanShot 2024-08-01 at 15 31 12](https://github.com/user-attachments/assets/ee97419a-d236-454a-824f-b4c9801d754b)


- 根據「營業稅電子資料申報繳稅作業要點」第20頁欄位詳細說明及第38頁（附件五）檔案格式欄位對照表：

  ![CleanShot 2024-08-01 at 15 40 36](https://github.com/user-attachments/assets/d7b127a6-0a77-4b03-ac10-c4b7be3ebf14)

  
  - 格式代號
    - 格式代號 21~29 屬於進項資料
    - 格式代號 31~38 屬於銷項資料
  - 共有四組欄位共用
    - （欄位位置 24-31）買受人統一編號 / 發票訖號
      - 屬於彙加資料
        - 銷項資料：為連續發票之訖號
      - 非屬銷項資料：進貨營業人統一編號，如無則為空白
    - （欄位位置 40-49）其他憑證號碼 / 公用事業載具流水編號
    - （欄位位置 50-61）銷售金額 / 營業稅稅基
      - 進項資料：營業稅稅基
      - 銷項資料：銷售金額
    - （欄位位置 80-80）彙加註記 / 分攤註記
      - A > 屬於彙加資料
        - 相依邏輯： 
          - 進項資料：第 32-35 欄為彙總張數
          - 銷項資料：第 24-31 欄為發票訖號
      - B > 屬於進項憑證分攤資料
        - 相依邏輯： 
          - 僅限格式代號為 25 時使用
          - 第 32-39 欄為銷售人統一編號
      - 空白 > 非彙加資料
        - 相依邏輯：
          - 進項資料：第 32-39 欄為銷售人統一編號
          - 銷項資料：第 24-31 欄為買受人統一編號
  - 依照屬性為進項或銷項資料及是否為彙加資料，欄位有多種排列組合（紅框框處）

## 圖例解析
是否被以上說明搞得頭昏眼花呢？以下提供圖例對應各種情況之欄位使用，在此之前需先分析該資料兩種屬性
- 進項資料 或是 銷項資料
- 彙加資料 或是 單一憑證


