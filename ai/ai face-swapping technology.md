<div align=center>

![portrait-person-ai-robot](https://github.com/user-attachments/assets/c7ec9000-59b4-4bcf-9fd6-2962df361d1d)


</div>

# AI face-swapping technology AI換臉技術探討

## 前言
你有曾看過迷因圖片的人物被換成其他明星的臉嗎?如果有的話，那就是所謂的 AI換臉技術(又可以稱作為「深偽技術」或 deepfake)。AI換臉是利用深度學習其中的生成對抗網絡(GANs)，將一個人的臉替換到另一個人的臉上，而現在會將此技術應用於照片或影片中。目前這項技術的正面用途包括電影特效、虛擬替身和娛樂業，但目前這項技術引發了許多道德與法律問題，如偽造AI換臉影片、身分竊取和隱私侵犯等。目前，全球各國和科技公司都在關注這項技術的監管與應用，並開發識別技術以防止惡意濫用。

接下來將會依據以下幾個主題進行敘述：
> AI如何做到風格模仿與遷移圖像?

> AI換臉應用介紹。

> AI換臉法律相關責任與疑慮。

## AI如何做到風格模仿與遷移圖像?
打開相機功能你會發現相機含有不同的濾鏡，無論是社群媒體的修圖工具或是美妝相機，在其中有大量的濾鏡與特效，而這部分功能其實也跟AI有相關聯。我們把這類型的技術稱為「風格模仿」，在此技術下AI所倚賴的是其「風格遷移(Style Transfer)」的技術，「風格遷移(Style Transfer)」使用深度神經網絡（DNNs）來將一幅圖像的風格應用到另一幅圖像上，同時保持原始內容。

> 以下圖舉例來說，我有一張狗的圖片但我想用梵谷星空的風格來重新詮釋這張圖片，就會得到一張梵谷星空繪畫風格的狗。

<div align=center>

![image](https://github.com/user-attachments/assets/48dc0574-8b14-4422-9fd7-c30132962d04)

</div>

### 風格遷移的原理
風格遷移(Style Transfer)的原理是基於卷積神經網絡(Convolutional Neural Networks, CNNs)提取的內容特徵和風格特徵，並通過優化生成一張結合兩者的圖像。

#### 1. 內容特徵與風格特徵
內容特徵：與圖像結構有關的特徵，代表物體的形狀、輪廓和佈局。例如，一張風景照片中的山脈、河流、建築等結構都屬於內容特徵。

風格特徵：與圖像的表面紋理、筆觸、顏色搭配等有關。例如，印象派畫作中的渦旋筆觸、顏色過渡、光影處理都是風格特徵。

#### 2. 卷積神經網絡在風格遷移中的作用
卷積神經網絡可以通過不同層次的卷積來提取圖像的不同特徵。神經網絡的前幾層通常提取的是圖像的低層次特徵(例如:邊緣、紋理)，這些特徵與風格相關；而更深的層次則提取高層次的特徵(例如:形狀、物體佈局)。因此，我們可以通過提取與控制這些層次的特徵就可以實現內容和風格的分離與重組。

<div align=center>

![image](https://github.com/user-attachments/assets/13e894ac-4f02-4fb5-9636-ac177fa96f30)

</div>

### 風格遷移的技術步驟
AI進行風格遷移(Style Transfer)會透過以下步驟來完成：

1. 載入內容圖像與風格圖像：將你想要的內容圖像和風格圖像輸入模型。

2. 特徵提取：使用預訓練的 CNN 模型來分別提取內容圖像和風格圖像的特徵，特別是 CNN 的中層和低層特徵分別對應內容和風格。

3. 生成新圖像：一個隨機初始化的圖像會被用來「學習」風格和內容的結合。通過優化這個圖像，逐步使其既匹配內容圖像的主要結構，又融合風格圖像的風格。

4. 損失函數：風格遷移過程中的關鍵是損失函數，這包括兩部分：

> 內容損失：確保生成的圖像與內容圖像在內容上保持一致。

> 風格損失：通過格拉姆矩陣（Gram Matrix）來計算風格圖像與生成圖像的風格相似性，確保風格的準確模仿。

5. 迭代更新：利用反向傳播算法更新生成的圖像，使其損失函數逐步減小，最終生成一幅同時具有內容圖像結構和風格圖像質感的新圖像。

### 圖像遷移技術 (Image Translation)
圖像遷移技術(Image Translation)顧名思義就是將圖像從一個領域轉換到另一個領域的技術。而這個領域可以包括風格、場景、物體、甚至是改變天氣的條件(大晴天轉變雷雨)。圖像遷移技術的目標是生成與輸入圖像不同，但仍保持一定對應性的圖像。

圖像遷移技術主要依賴深度學習模型中的生成模型，尤其是生成對抗網絡（Generative Adversarial Networks, GANs）以及它們的變體。從圖像遷移技術的基本概念來說，圖像遷移是包含多種形式的，例如：

> 風格轉換：將一張圖片的風格轉化為另一種風格，像前面所提到的將一張狗的照片變成梵谷的狗畫作。

> 屬性轉換：改變圖像的某些屬性。例如將本來大晴天的照片轉換為雨天場景。

> 物體轉換：將一種物體轉換為另一種物體。在動物園拍照把拍到的老虎轉換成花豹。

<div align=center>
  
![image](https://github.com/user-attachments/assets/1ab26226-2046-4435-aba3-a150b2f378ff)

</div>

圖像遷移技術(Image Translation) 與 生成對抗網絡 (GANs) 有著密切的關係，圖像遷移的發展與生成對抗網路非常相關，生成對抗網路(GANs) 是一種由兩個神經網絡組成的系統，包含了生成器(Generator)和鑑別器(Discriminator)。這兩個網路相互競爭，生成器嘗試創建逼真的圖像，而鑑別器則學習區分生成的圖像和真實的圖像。透過大量的訓練運行，生成器會變得越來越擅長創造逼近真實的圖像，直到鑑別器沒辦法區分生成與真實差異。

## AI換臉應用
AI face-swapping technology 在技術層面上的核心也是生成對抗網絡(GANs)，其實換臉技術也跟圖像遷移置換有正相關聯，但換臉技術針對的是訓練(GANs)學習不同臉部的特徵，並且將這些特徵應用在指定的目標圖片或影片。臉部最明顯的特徵就是五官，可以想像(GANs)透過訓練能夠輕鬆生成各種五官並且放置在你指定的圖像中。

以整體AI換臉技術過程包括以下幾個步驟：

1.臉部偵測與標記：第一步，AI會去偵測並標記臉部的關鍵點，主要為五官，這些標記點用於準確地將一張臉「貼合」到另一張臉上。

2.資料訓練：模型需要大量的臉部影像資料進行訓練，特別是來源人物的多角度臉部影像，從而學習該臉部的獨特特徵和表情變化，避免只是單純的複製貼上。

3.面部特徵轉換：生成器利用訓練數據生成一張模擬的臉部，並進行面部表情、角度、光影的調整，以實現自然的過渡和換臉效果。

4.圖像融合：生成的臉部需要與目標影片或圖片中的原始背景進行無縫融合，包括光影的對應、膚色的調整、邊緣的平滑處理等效果。

5.實時應用：當技術成熟後，可以應用於實時的影片換臉，但這需要更強大的計算能力來即時處理影片中的每一幀。

### AI換臉技術上遇到挑戰
隨著換臉技術發展逐步成熟且推出相關類似應用後，生成對抗網路的模型資料庫變得更加強大，現在許多電影使用替身加上換臉技術已經沒有辦法讓觀眾看出任何破綻。而此項技術發展成熟有正向應用必定有反向的效果，此技術面臨的挑戰如下列：

高品質的資料需求：因現在許多影像與圖片質量較高，如果要生成高質量的換臉效果，生成模型就需要大量高清影像資料來訓練，特別是多角度和多光線條件下的人臉。

計算資源：訓練深度學習模型需要強大的計算資源，包括高性能的 GPU 來加速訓練過程。

真實性難度：隨著技術的進步，生成逼真的換臉變得更加容易，但部分細節還需要克服，目前還是有部分失真和假象，像是在眼睛、嘴唇移動和光線反應上。換臉技術的發展速度很快，尤其是在影視遊戲娛樂產業和虛擬實境等領域，它提供了極大的創新潛力，但隨之而來的也是日益增長的技術與道德挑戰。

<div align=center>

![image](https://github.com/user-attachments/assets/e17e026f-cfff-4592-8456-5e8d38c4cec2)

</div>

## AI換臉法律相關責任與疑慮


## 總結


## Reference
- [風格遷移.利用AI將普通圖片變成大師畫作](https://medium.com/@lifelab.tw/%E9%A2%A8%E6%A0%BC%E9%81%B7%E7%A7%BB-%E5%88%A9%E7%94%A8ai%E5%B0%87%E6%99%AE%E9%80%9A%E5%9C%96%E7%89%87%E8%AE%8A%E6%88%90%E5%A4%A7%E5%B8%AB%E7%95%AB%E4%BD%9C-5de6fabe62f3)

- [深度學習Paper系列(10)：CycleGAN](https://tomohiroliu22.medium.com/%E6%B7%B1%E5%BA%A6%E5%AD%B8%E7%BF%92paper%E7%B3%BB%E5%88%97-10-cyclegan-d7c88cc8dd60)

- [AI可以換臉嗎？](https://www.isuperman.tw/ai%E5%8F%AF%E4%BB%A5%E6%8F%9B%E8%87%89%E5%97%8E%EF%BC%9F/)

- [【科技新知】什麼是Deepfake？人工換臉技術？](https://1on1.today/blog/%E4%BB%80%E9%BA%BC%E6%98%AFdeepfake-%E4%BA%BA%E5%B7%A5%E6%8F%9B%E8%87%89%E6%8A%80%E8%A1%93/)
